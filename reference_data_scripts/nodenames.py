# Node-to-facility name dictionary
import os
import json

#node_names = get_node_names()

'''
node_names = { 1633100347: '81102_7',  1635066454: '80203_6',  1637360242: '80208_10', 1632379437: '81111_11', 
               1631920687: '81111_3',  1632117296: '81111_10', 1632248369: '81111_7',  1632444978: '81111_8', 
               1633362483: '81102_2',  1632444980: '81111_9',  1632576053: '81111_12', 1632903735: '81102_9', 
               1633100344: '81102_4',  1636704880: '80210_2',  1632969274: '81102_6',  1633428027: '81102_5', 
               1633231420: '81102_1',  1633165886: '80204_6',  1632313919: '80204_4',  1632510528: '80204_1', 
               1632182850: '80204_9',  1633690179: '80211_1',  1633165892: '80204_5',  1632969285: '80204_2', 
               1633165895: '80211_6',  1633821260: '80211_7',  1632510541: '80211_4',  1634673230: '80203_1', 
               1634673232: '80203_9',  1634607697: '80203_2',  1633821266: '80211_8',  1633559139: '80209_10', 
               1634935380: '80203_5',  1634083413: '80202_2',  1635328598: '80202_6',  1634804312: '80202_8', 
               1636639321: '80202_3',  1633821275: '80209_8',  1635721820: '80202_7',  1635197534: '80202_4', 
               1636180575: '80208_7',  1636835938: '80208_9',  1634214499: '80209_9',  1633952356: '80209_4', 
               1634738789: '80209_6',  1634280040: '80209_2',  1635000937: '80209_1',  1634738794: '80209_7', 
               1635918443: '80208_1',  1634017900: '80207_4',  1634280046: '80207_9',  1635394160: '80201_8', 
               1633297009: '80206_6',  1635132018: '80201_1',  1634935411: '80207_10', 1632641652: '80206_4', 
               1634607730: '80207_7',  1632641654: '80206_3',  1633297001: '80207_5',  1634411088: '80202_9', 
               1636639354: '80210_7',  1636835963: '80210_10', 1633886826: '80207_3',  1636311660: '80208_5', 
               1635656297: '80208_4',  1633821294: '80207_6',  1635394129: '80203_3',  1633559152: '80206_7', 
               1633034866: '80206_2',  1635394164: '80201_2',  1632707187: '80206_1',  1636311653: '80208_6', 
               1637360229: '80208_2',  1633886836: '80207_1',  1636639348: '80210_5',  1635590773: '80201_6', 
               1632707190: '80206_5',  1636508279: '80210_11', 1635721845: '80201_5',  1634411128: '80207_2', 
               1636442738: '80210_12', 1631855153: '81111_1',  1635852918: '80201_4',  1635328637: '80201_3', 
               1634411092: '80202_5',  1634804308: '80203_8',  1636180565: '80202_1',  1632117293: '81111_6', 
               1636115064: '80210_6',  1632707121: '81111_5',  1635656312: '80201_7',  1632248372: '81111_4', 
               1636770422: '80210_4',  1632641588: '81111_2',  1632838197: '81102_10', 1633296952: '81102_3', 
               1636180600: '80210_9',  1631920699: '80204_3',  1633690217: '80207_8',  1633034804: '81102_8', 
               1632838207: '80204_8',  1636311668: '80210_8',  1637556842: '80208_8',  1636246136: '80210_1', 
               1632641605: '80204_7',  1637032573: '80210_3',  1633296973: '80211_5',  1634017870: '80211_3', 
               1633034832: '80211_2',  1637950058: '80208_3',  1634738769: '80203_7',  1634542162: '80203_11', 
               1634476625: '80203_4',  1635000916: '80203_10', 1635000942: '80209_3',  1633493589: '80209_5' }
'''


with open(os.path.join('C:\\Users\\Mnikolov\\Zambia-raw\\dtk-scripts\\calibration\\reference_data_scripts','nodenames.json'),'r') as n_f:
    node_names = json.load(n_f)            
node_names = dict([(int(node_id), cluster_id) for node_id, cluster_id in node_names.iteritems()])


#bad 1632707190:80206_5, 1634935411:80207_10
#good 1633034832:80211_2, 1634411088:80202_9

reverse_node_names={v:k for (k,v) in node_names.items()}

# Health-facility-code to health-facility-name dictionary
health_facility_names = { 80206: 'Gwembe',
                          80207: 'Lukonde',
                          80201: 'Bbondo',
                          80210: 'Nyanga',
                          80204: 'Chisanga',
                          80209: 'Munyumbwe',
                          80211: 'Sinafala',
                          81111: 'Sinamalima',
                          81102: 'Chiyabi',
                          80203: 'Chipepo',
                          80202: 'Chabbobboma',
                          80208: 'Luumbo' }

# List of nodeIDs by health-facility name
nodeids_by_facility = {}
for facilityname in health_facility_names.values():
    nodeids_by_facility[facilityname]=[]
for nodeid,clustercode in node_names.items():
    facilitycode=int(clustercode.split('_')[0])
    facilityname=health_facility_names[facilitycode]
    nodeids_by_facility[facilityname].append(nodeid)
    

hfca_id_cluster_ids = {}
for hfca_id in health_facility_names.keys():
    hfca_id_cluster_ids[hfca_id]=[]
for nodeid,cluster_id in node_names.iteritems():
    hfca_id=int(cluster_id.split('_')[0])
    hfca_id_cluster_ids[hfca_id].append(cluster_id)
    

def nodes_from_facilities(facilities):
    nodes=[]
    for f in facilities:
        nodes.extend(nodeids_by_facility[f])
    return nodes

def get_node_names():
    node_names = {}
    
    